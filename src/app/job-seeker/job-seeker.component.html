<div class="container mt-5 d-flex flex-column" style="min-height: 80vh;">
  <div class="flex-grow-0" style="min-height: 45vh;">
    <form [formGroup]="jobForm" (ngSubmit)="onSubmit()" novalidate>
      <div class="row g-3 align-items-end">
        <div class="col-md-3">
          <label for="jobTitle" class="form-label">Job Title <span class="text-danger">*</span></label>
          <input type="text" id="jobTitle" class="form-control" formControlName="jobTitle" required />
          <div *ngIf="submitted && jobForm.get('jobTitle')?.invalid" class="text-danger small">Job Title is required.</div>
        </div>
        <div class="col-md-3">
          <label for="company" class="form-label">Company <span class="text-danger">*</span></label>
          <input type="text" id="company" class="form-control" formControlName="company" required />
          <div *ngIf="submitted && jobForm.get('company')?.invalid" class="text-danger small">Company is required.</div>
        </div>
        <div class="col-md-3">
          <label for="jobUrl" class="form-label">Job URL</label>
          <input type="url" id="jobUrl" class="form-control" formControlName="jobUrl" />
        </div>
        <div class="col-md-3">
          <label for="resumeUpload" class="form-label">Upload Resume (PDF, DOC, DOCX only)</label>
          <input type="file" id="resumeUpload" class="form-control" (change)="onFileSelected($event)" accept=".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" multiple />
          <div *ngIf="fileError" class="text-danger small">{{ fileError }}</div>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-12">
          <label for="jobDescription" class="form-label">Job Description</label>
          <textarea id="jobDescription" class="form-control" formControlName="jobDescription" rows="2"></textarea>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-12">
          <button type="submit" class="btn btn-primary" [disabled]="jobForm.invalid">Submit</button>
        </div>
      </div>
    </form>
  </div>

  <div class="flex-grow-1 overflow-auto mt-4" style="min-height: 45vh;">
    <div *ngIf="uploadedResumes.length > 0">
      <h5>Uploaded Resumes</h5>
      <table mat-table [dataSource]="uploadedResumes" class="mat-elevation-z2 w-100">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Resume Name</th>
          <td mat-cell *matCellDef="let resume">{{ resume.name }}</td>
        </ng-container>
        <ng-container matColumnDef="jobTitle">
          <th mat-header-cell *matHeaderCellDef>Job Title</th>
          <td mat-cell *matCellDef="let resume">{{ resume.jobTitle }}</td>
        </ng-container>
        <ng-container matColumnDef="company">
          <th mat-header-cell *matHeaderCellDef>Company</th>
          <td mat-cell *matCellDef="let resume">{{ resume.company }}</td>
        </ng-container>
        <ng-container matColumnDef="atsScore">
          <th mat-header-cell *matHeaderCellDef>ATS Score</th>
          <td mat-cell *matCellDef="let resume">{{ resume.atsScore }}%</td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let resume">
            <button mat-icon-button color="primary" (click)="openResumeDialog(resume)">
              <mat-icon>visibility</mat-icon>
            </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </div>
</div>
